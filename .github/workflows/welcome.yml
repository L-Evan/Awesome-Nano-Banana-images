name: Welcome New Contributors

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

permissions:
  issues: write
  pull-requests: write

jobs:
  welcome:
    runs-on: ubuntu-latest
    steps:
      - name: Welcome New Issue Creator
        if: github.event_name == 'issues'
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const creator = issue.user.login;

            // æ£€æŸ¥æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡åˆ›å»º Issue
            const issues = await github.rest.issues.listForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
              creator: creator,
              state: 'all'
            });

            if (issues.data.length === 1) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                body: `ğŸ‰ **æ¬¢è¿ @${creator}ï¼**\n\næ„Ÿè°¢ä½ æäº¤çš„ç¬¬ä¸€ä¸ª Issueï¼\n\næˆ‘ä»¬ä¼šå°½å¿«å¤„ç†ã€‚åœ¨ç­‰å¾…æœŸé—´ï¼Œä½ å¯ä»¥ï¼š\n- ğŸ“– æµè§ˆ [æ¡ˆä¾‹åº“](https://github.com/${context.repo.owner}/${context.repo.repo}/tree/main/showcases)\n- ğŸ¨ å°è¯•åœ¨ [nanobanana2ai.art](https://nanobanana2ai.art) å®è·µï¼ˆä¼˜æƒ ç : **BANANA25**ï¼‰\n- ğŸ’¬ å‚ä¸ [Discussions](https://github.com/${context.repo.owner}/${context.repo.repo}/discussions)\n\næœŸå¾…ä½ çš„æ›´å¤šè´¡çŒ®ï¼ ğŸš€`
              });
            }

      - name: Welcome New PR Contributor
        if: github.event_name == 'pull_request_target'
        uses: actions/github-script@v7
        with:
          script: |
            const pr = context.payload.pull_request;
            const creator = pr.user.login;

            // æ£€æŸ¥æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡æäº¤ PR
            const prs = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'all',
              creator: creator
            });

            if (prs.data.length === 1) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: pr.number,
                body: `ğŸ‰ **æ¬¢è¿ @${creator} çš„ç¬¬ä¸€ä¸ª PRï¼**\n\næ„Ÿè°¢ä½ çš„è´¡çŒ®ï¼ä½ çš„ PR å·²ç»æäº¤æˆåŠŸã€‚\n\n## ğŸ“‹ æ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\n1. âœ… **è‡ªåŠ¨æ£€æŸ¥**: CI ä¼šè‡ªåŠ¨éªŒè¯ä½ çš„æäº¤\n2. ğŸ‘€ **äººå·¥å®¡æ ¸**: ç»´æŠ¤è€…ä¼šåœ¨ 3-7 å¤©å†…å®¡æ ¸\n3. ğŸ’¬ **åé¦ˆä¿®æ”¹**: å¦‚éœ€ä¿®æ”¹ï¼Œæˆ‘ä»¬ä¼šåŠæ—¶åé¦ˆ\n4. ğŸŠ **åˆå¹¶å‘å¸ƒ**: é€šè¿‡åä¼šåˆå¹¶åˆ°ä¸»åˆ†æ”¯\n\n## ğŸ è´¡çŒ®è€…ç¦åˆ©\n\n- ğŸ† ä½ çš„åå­—å°†å‡ºç°åœ¨ [CONTRIBUTORS.md](https://github.com/${context.repo.owner}/${context.repo.repo}/blob/main/CONTRIBUTORS.md)\n- ğŸ“¢ ä¼˜ç§€ä½œå“å¯èƒ½è·å¾—å®˜æ–¹æ¨å¹¿\n- ğŸ æ´»è·ƒè´¡çŒ®è€…æœ‰æœºä¼šè·å¾—é¢å¤–ä¼˜æƒ ç \n\n## ğŸ’¡ æç¤º\n\næ¨èä½¿ç”¨ [nanobanana2ai.art](https://nanobanana2ai.art) éªŒè¯ä½ çš„æç¤ºè¯æ•ˆæœï¼ˆä¼˜æƒ ç : **BANANA25**ï¼‰\n\nå†æ¬¡æ„Ÿè°¢ä½ çš„è´¡çŒ®ï¼ ğŸ™Œ`
              });
            }
